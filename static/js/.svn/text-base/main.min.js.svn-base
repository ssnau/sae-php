
(function($){$.extend($.fn,{enableMiniScroll:(function(){var bMouseDown=false;return function(conf){conf=$.extend({scrollWidth:"15",wheelMeta:"30",defaultColor:"#999",hoverColor:"#aaa",downColor:"#777",margin:3,minHeight:40,fault:0},conf);return this.each(function(){var elContent=this,ndContent=$(this),ndThis=$(this);var ndContainer=$(this).parent();var ndScroll=$("<div class='scrollbar' style='position:absolute;background-color:#999; border-radius:2px;'></div>"),elScroll=ndScroll[0];var eventNamespace="."+ndThis.attr('id');if(ndContainer.css("position")==="static"){ndContainer.css("position","relative");}
ndScroll.appendTo(ndContainer);ndScroll.css({width:conf.scrollWidth+'px',right:3+'px'});var preY=null;var minTop=conf.margin-0,maxTop;var containerHeight=ndContainer.height();var listTotalHeight,listHeight,scrollDistance,totalScrollTop,scrollHeight;$(this).bind('contentChange',init);function init(){listTotalHeight=elContent.scrollHeight-conf.fault;listHeight=ndContent.height();scrollHeight=listTotalHeight-listHeight;if(scrollHeight>listHeight-conf.minHeight){ndScroll.show();scrollHeight=conf.minHeight;}else if(scrollHeight<=0){ndScroll.hide();}else{ndScroll.show();scrollHeight=listHeight-scrollHeight;}
ndScroll.height(scrollHeight);totalScrollTop=listTotalHeight-listHeight;maxTop=containerHeight-scrollHeight-conf.margin;scrollDistance=maxTop-minTop;var top=Math.ceil(elContent.scrollTop*scrollDistance/totalScrollTop)+minTop;top=(top<=minTop)?minTop:(top>maxTop)?maxTop:(top);ndScroll.css('top',top+"px");}
init();ndScroll.hover(function(){ndScroll.css('background-color',conf.hoverColor);},function(){ndScroll.css('background-color',conf.defaultColor);});ndScroll.bind('mousedown'+eventNamespace,function(e){ndScroll.css('background-color',conf.downColor);bMouseDown=true;e.preventDefault();});$(document).bind('mouseup'+eventNamespace,function(e){ndScroll.css('background-color',conf.defaultColor);if(bMouseDown){bMouseDown=false;e.preventDefault();}});$(document).bind('mousemove'+eventNamespace,function(e){var distance;var top=(ndScroll.css('top')+"").slice(0,-2)-0;if(bMouseDown){if(preY){distance=e.pageY-preY;ndScroll.trigger("move",[distance,top]);e.preventDefault();}}
preY=e.pageY;});ndScroll.bind("move"+eventNamespace,function(e,distance,top){top=top?top:(ndScroll.css('top')+"").slice(0,-2)-0;distance=(distance?distance:0)-0;top=top+distance;top=(top<=minTop)?minTop:(top>maxTop)?maxTop:(top);ndScroll.css('top',top+'px');elContent.scrollTop=Math.ceil((top-minTop)*totalScrollTop/scrollDistance);});var mousewheel=jQuery.browser.mozilla?'DOMMouseScroll':'mousewheel';ndContent.bind(mousewheel+eventNamespace,function(e){e.preventDefault();e.stopPropagation();e=e.originalEvent;var isUp=(e.wheelDelta?e.wheelDelta:e.detail)>0?true:false;isUp=jQuery.browser.mozilla?!isUp:isUp;var counts=conf.wheelMeta;if(jQuery.browser.msie||jQuery.browser.mozilla){ndScroll.trigger('move',isUp?[-conf.wheelMeta]:[conf.wheelMeta]);}else{setTimeout(function(){if(counts>0){ndScroll.trigger('move',isUp?[-1]:[1]);counts--;setTimeout(arguments.callee,10);}},0);}});});};})()});})(jQuery);(function($){$.extend($.fn,{enablePlaceholder:function(conf){var inputEle=document.createElement('input');if('placeholder'in inputEle){return;}
return this.each(function(index,ele){var nd=$(ele);var text=nd.attr('placeholder');if(!text)return;var originalColor=nd.css('color');var isHolder=true;nd.focus(function(){if(isHolder){nd.css('color',originalColor);nd.val('');}});nd.blur(function(){if(!nd.val()){nd.val(text);nd.css('color','#ccc');isHolder=true;}});nd.keyup(function(){isHolder=nd.val()?false:true;});nd.blur();});}});})(jQuery);(function($){$.extend({receiveJSON:function(action,param,func){if(typeof param==='function'){func=param;param='';}
$.get(action,param,function(res){try{res=$.parseJSON(res);}catch(e){}finally{res=(typeof res==="string"||!res)?{'status':false,'msg':res}:res;res.status=res.status-0;func(res);}});}});})(jQuery);(function($){$.extend($.fn,{enableDrag:(function(){var dragIndex=10;return function(ndDrag,ndOverlay){var bMouseDown=false;var ndThis=$(this),ndDocument=$(document);var eventNamespace="."+ndThis.attr('id');ndOverlay=ndOverlay?ndOverlay:{show:function(){},hide:function(){}};var preX=null,preY=null;if(ndDrag.length){ndDrag.bind('mousedown'+eventNamespace,function(e){bMouseDown=true;ndThis.css('z-index',++dragIndex);ndOverlay&&ndOverlay.show();e.preventDefault();});ndDocument.bind('mouseup'+eventNamespace,function(e){if(bMouseDown){bMouseDown=false;ndOverlay&&ndOverlay.hide();e.preventDefault();}});ndDocument.bind('mousemove'+eventNamespace,function(e){var tDistance,lDistance;var top=(ndThis.css('top')+"").slice(0,-2)-0;var left=(ndThis.css('left')+"").slice(0,-2)-0;if(bMouseDown){if(preY){tDistance=e.pageY-preY;lDistance=e.pageX-preX;e.preventDefault();ndThis.css('top',(top+tDistance)+'px');ndThis.css('left',(left+lDistance)+'px');}}
preY=e.pageY;preX=e.pageX;});}}})()});})(jQuery);(function($){$.extend($.fn,{enableResize:function(ndResizeBar,conf){var ndThis=$(this),ndDocument=$(document);var bMouseDown=false;var eventNamespace="."+ndThis.attr('id');conf=$.extend({ndHorizon:ndThis,ndVertical:ndThis,ndFrameOverlay:{show:function(){}}},conf);var ndHorizon=conf.ndHorizon,ndVertical=conf.ndVertical,ndFrameOverlay=conf.ndFrameOverlay;var preX=null,preY=null;ndResizeBar.bind('mousedown'+eventNamespace,function(e){bMouseDown=/\d/.exec(e.target.className)+"";ndTarget=$(e.target);ndFrameOverlay.show();e.preventDefault();});ndDocument.bind('mouseup'+eventNamespace,function(e){if(bMouseDown){bMouseDown=false;ndFrameOverlay.hide();e.preventDefault();}});ndDocument.bind('mousemove'+eventNamespace,function(e){var yDistance,xDistance;if(bMouseDown){if(preY){xDistance=e.pageX-preX;yDistance=e.pageY-preY;e.preventDefault();if(yDistance||xDistance){resize(xDistance,yDistance);}}}
preY=e.pageY;preX=e.pageX;});function resize(x,y){if(!bMouseDown)return;var top=(ndThis.css('top')+"").slice(0,-2)-0;var left=(ndThis.css('left')+"").slice(0,-2)-0;var width=ndHorizon.width()-0;var height=ndVertical.height()-0;switch(bMouseDown-0){case 1:ndHorizon.width(width-x);ndVertical.height(height+y);ndThis.css('left',left+x+'px');break;case 2:ndVertical.height(height+y);break;case 3:ndHorizon.width(width+x);ndVertical.height(height+y);break;case 4:ndThis.css('left',left+x+'px');ndHorizon.width(width-x);break;case 6:ndHorizon.width(width+x);break;case 7:ndThis.css('top',top+y+'px');ndThis.css('left',left+x+'px');ndHorizon.width(width-x);ndVertical.height(height-y);break;case 8:ndThis.css('top',top+y+'px');ndVertical.height(height-y);break;case 9:ndThis.css('top',top+y+'px');ndHorizon.width(width+x);ndVertical.height(height-y);break;}}
return ndThis;}});})(jQuery);(function($){document['click_fn']=[];$(document).click(function(){$.each(document['click_fn'],function(index,val){val.fn();});});$.extend({addDocumentClick:function(obj){document['click_fn'].push(obj);},removeDocumentClick:function(name){var click_fn=document['click_fn'];for(var i=0;i<click_fn.length;i++){if(click_fn[i]['name']==name){click_fn.splite(i,1);}}}});})(jQuery);(function($){Xtemplate=function(id){!!id&&(this['text']=document.getElementById(id).innerHTML);}
Xtemplate.prototype.setVar=function(args){var msg=this['text'];$.each(args,function(name,val){msg=msg.replace("${"+name+"}",val);});this['text']=msg;};Xtemplate.prototype.setText=function(text){this['text']=text;};Xtemplate.prototype.getText=function(args){return this['text'];};Xtemplate.prototype.fill=function(text){var msg=this['text'];msg=msg.replace(/\${\w+}/g,text);this['text']=msg;}})(jQuery);(function($){$.extend({nilfunc:function(){},keyCode:{'ENTER':13,'ESC':18,'BACKSPACE':8}});})(jQuery);(function($){$.extend($.fn,{'findParent':function(str){var type=null;if(/^\./.test(str)){type='class';}else if(/^#/.test(str)){type='id';}
var identical=str.substr(1);var ret;this.each(function(index,val){var nd=$(this).parent();while(nd.length){if(type==='id'&&nd.attr('id')==identical){ret=nd;return false;}else if(type==='class'&&nd.hasClass(identical)){ret=nd;return false;}
nd=nd.parent();}});return ret;}});})(jQuery);$.each(['article','aside','details','figcaption','figure','footer','header','hgroup','menu','nav','section'],function(index,val){document.createElement(val);});$(document).delegate('.close','click',function(e){var ndThis=$(this);var ndWindowDiv=ndThis.findParent('.window');ndWindowDiv&&ndWindowDiv.hide();});$(document).delegate('#ie-warning .close','click',function(e){document.cookie="already_know_ie=true";alert('cc');});